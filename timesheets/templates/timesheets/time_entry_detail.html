
{% extends 'timesheets/base.html' %}

{% block title %}Time Entries Detailed View - Time Sheet App{% endblock %}

{% block content %}
<style>

        
    </style>

    <div class="timesheet-form">
        <h2>Timesheet</h2>
                <a style="text-align: right;"> Date: {{ time_entry.date }} | Name: {{ request.user.first_name }} {{ request.user.last_name }}</a>
        <table>
        <thead>
            <tr>
                <th class="header" colspan="2">Client/Job</th>
                <th class="header">NST Job #</th>
                <th class="header" colspan="2">Time</th>
                <th class="header" colspan="2">Mileage</th>
                <th class="header" colspan="2">Services Performed</th>
            </tr>
            <tr>
                <th colspan="2"></th>
                <th></th>
                <th>Arrive</th>
                <th>Leave</th>
                <th>Arrive</th>
                <th>Leave</th>
                <th>Labor Code</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>
            <!-- First row with Start Time label -->
            <tr>
                <td class="header">Start Location:</td>
                <td>{{ time_entry.start_location }}</td>
                <td class="header"></td>
                <td class="header"></td>
                <td>{{ time_entry.initial_leave_time|date:"H:i" }}</td> <!-- 24-hour format -->
                <td class="header"></td>
                <td>{{ time_entry.initial_mileage }}</td>
                <td class="header" colspan="2"></td>
            </tr>
            <!-- Repeat this block for additional rows -->
            {% for job in time_entry.jobs.all %}
            <tr>
                <td colspan="2">{{ job.job_description }}</td>
                <td>{{ job.job_number }}</td>
                <td>{{ job.activity_arrive_time|date:"H:i" }}</td> <!-- 24-hour format -->
                <td>{{ job.activity_leave_time|date:"H:i" }}</td> <!-- 24-hour format -->
                <td>{{ job.activity_start_mileage }}</td>
                <td>{{ job.activity_end_mileage }}</td>
                <td>{{ job.labor_code }}</td>
                <td>{{ job.labor_code_description }}</td> <!-- Labor code with description -->
            </tr>
            {% endfor %}
            <!-- Add more rows as needed -->
            <tr>
                <td class="header">End Location:</td>
                <td>{{ time_entry.end_location }}</td>
                <td class="header"></td>
                <td>{{ time_entry.final_arrive_time|date:"H:i" }}</td> <!-- 24-hour format -->
                <td class="header"></td>
                <td>{{ time_entry.final_mileage }}</td>
                <td class="header" colspan="3"></td>
            </tr>
        </tbody>
        <tfoot>
            <tr>
                <td>{{ time_entry.hours_on_site }}</td>
                <td>{{ time_entry.hours_for_the_day }}</td>
                <td>{{ time_entry.travel_time_subtract }}</td>
                <td>{{ time_entry.hours_to_be_paid }}</td>
                <td colspan="2" style="height: 30px;"></td>
                <td>{{ time_entry.total_miles }}</td>
                <td>{{ time_entry.travel_miles_subtract }}</td>
                <td>{{ time_entry.miles_to_be_paid }}</td>
            </tr>
            <tr>
                <td>Hours on Site:</td>
                <td>Hours for the Day:</td>
                <td>Travel Time (subtract):</td>
                <td>Hours to be Paid:</td>
                <td colspan="2">Employee's Signature</td>
                <td>Total Miles:</td>
                <td>Travel Miles (subtract):</td>
                <td>Miles to be Paid</td>
            </tr>
        </tfoot>
    </table>
    <div class="workspace-section print-only">
    <!-- Add the Supervisor's Initials and Workspaces section -->
    <table>
        <tr>
            <td colspan="9" style="text-align: center; padding-bottom: 10px; height: 30px;">

            </td>
        </tr>
        <tr>
            <td colspan="9" style="text-align: center; padding-bottom: 10px;">
                Supervisor's Initials
            </td>
        </tr>
        <!-- Spacer row for extra space above workspaces -->
        <tr>
            <td colspan="7" style="height: 30px;">{{ time_entry.comments }}</td>
            <td colspan="3" style="height: 30px;"></td>
        </tr>
        <tr>
            <td colspan="7" style="text-align: center;">Technician's Workspace</td>
            <td colspan="3" style="text-align: center;">Accounting Workspace - Do Not Write Here</td>
        </tr>
    </table>
    <div>
        <table>
            <!-- Spacer row for extra space above next section -->
            <tr>
                <td colspan="7" style="height: 30px;"></td>
                <td colspan="1.5" style="height: 30px;"></td>
                <td colspan="1.5" style="height: 30px;"></td>
            </tr>
            <tr>
                <td colspan="7" style="text-align: center;">Supervisor's Workspace</td>
                <td colspan="1.5" style="text-align: center;">Accounting Manager's Initials</td>
                <td colspan="1.5" style="text-align: center;">Controller's Initials</td>
            </tr>
        </table>
    </div>

    
</div>
<div class="button-container">
    <button onclick="window.print()">Print</button>
    <button><a href="{% url 'time_entry_edit' time_entry.pk %}">Edit</a></button>
    <button><a href="{% url 'time_entry_list' %}">Back to List</a></button>
</div>
<h3>Job Calculations</h3>
<table>
    <thead>
        <tr>
            <th>Job Description</th>
            <th>Job Number</th>
            <th>Miles for Job</th>
            <th>Time for Job</th>
        </tr>
    </thead>
    <tbody>
        {% for job in time_entry.jobs.all %}
        <tr>
            <td>{{ job.job_description }}</td>
            <td>{{ job.job_number }}</td>
            <td>{{ job.job_number.distance_office }}</td>
            <td>{{ job.job_number.time_office }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
<h2>Time Calculations</h2>

<h3>First Leg Calculations</h3>
<p>Travel Time First Leg: {{ time_entry.travel_time_first_leg }} hours</p>
<p>Standard Time from Office to First Job: {{ time_entry.time_office_to_first_job }} hours</p>
<p>Unpaid Travel Time First Leg: {{ time_entry.unpaid_travel_time_first_leg }} hours</p>

<h3>Last Leg Calculations</h3>
<p>Travel Time Last Leg: {{ time_entry.travel_time_last_leg }} hours</p>
<p>Standard Time from Last Job to Office: {{ time_entry.time_last_job_to_office }} hours</p>
<p>Unpaid Travel Time Last Leg: {{ time_entry.unpaid_travel_time_last_leg }} hours</p>

<h3>Total Unpaid Travel Time</h3>
<p>Total Unpaid Travel Time: {{ time_entry.total_unpaid_travel_time }} hours</p>

<h2>Distance Calculations</h2>

<h3>First Leg Calculations</h3>
<p>Miles Traveled First Leg: {{ time_entry.miles_traveled_first_leg }} miles</p>
<p>Standard Distance from Office to First Job: {{ time_entry.distance_office_to_first_job }} miles</p>
<p>Miles to Pay First Leg: {{ time_entry.miles_to_pay_first_leg }} miles</p>

<h3>Last Leg Calculations</h3>
<p>Miles Traveled Last Leg: {{ time_entry.miles_traveled_last_leg }} miles</p>
<p>Standard Distance from Last Job to Office: {{ time_entry.distance_last_job_to_office }} miles</p>
<p>Miles to Pay Last Leg: {{ time_entry.miles_to_pay_last_leg }} miles</p>



{% endblock %}
