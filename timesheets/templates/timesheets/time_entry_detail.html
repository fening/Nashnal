
{% extends 'timesheets/base.html' %}

{% block title %}Time Entries Detailed View - Time Sheet App{% endblock %}

{% block content %}
{% load custom_filters %}
<style>

        
    </style>

    <div class="timesheet-form">
        <h2>Timesheet</h2>
                <a style="text-align: right;"> Date: {{ time_entry.date }} | Name: {{ request.user.first_name }} {{ request.user.last_name }}</a>
        <table>
        <thead>
            <tr>
                <th class="header" colspan="2">Client/Job</th>
                <th class="header">NST Job #</th>
                <th class="header" colspan="2">Time</th>
                <th class="header" colspan="2">Mileage</th>
                <th class="header" colspan="2">Services Performed</th>
            </tr>
            <tr>
                <th colspan="2"></th>
                <th></th>
                <th>Arrive</th>
                <th>Leave</th>
                <th>Arrive</th>
                <th>Leave</th>
                <th>Labor Code</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>
            <!-- First row with Start Time label -->
            <tr>
                <td class="header">Start Location:</td>
                <td>{{ time_entry.start_location }}</td>
                <td class="header"></td>
                <td class="header"></td>
                <td>{{ time_entry.initial_leave_time|date:"H:i" }}</td> <!-- 24-hour format -->
                <td class="header"></td>
                <td>{{ time_entry.initial_mileage }}</td>
                <td class="header" colspan="2"></td>
            </tr>
            <!-- Repeat this block for additional rows -->
            {% for job in time_entry.jobs.all %}
            <tr>
                <td colspan="2">{{ job.job_description }}</td>
                <td>{{ job.job_number }}</td>
                <td>{{ job.activity_arrive_time|date:"H:i" }}</td> <!-- 24-hour format -->
                <td>{{ job.activity_leave_time|date:"H:i" }}</td> <!-- 24-hour format -->
                <td>{{ job.activity_start_mileage }}</td>
                <td>{{ job.activity_end_mileage }}</td>
                <td>{{ job.labor_code }}</td>
                <td>{{ job.labor_code_description }}</td> <!-- Labor code with description -->
            </tr>
            {% endfor %}
            <!-- Add more rows as needed -->
            <tr>
                <td class="header">End Location:</td>
                <td>{{ time_entry.end_location }}</td>
                <td class="header"></td>
                <td>{{ time_entry.final_arrive_time|date:"H:i" }}</td> <!-- 24-hour format -->
                <td class="header"></td>
                <td>{{ time_entry.final_mileage }}</td>
                <td class="header" colspan="3"></td>
            </tr>
        </tbody>
        <tfoot>
            <tr>
                <td>{{ time_entry.hours_on_site }}</td>
                <td>{{ time_entry.hours_for_the_day }}</td>
                <td>{{ time_entry.travel_time_subtract }}</td>
                <td>{{ time_entry.hours_to_be_paid }}</td>
                <td colspan="2" style="height: 30px;"></td>
                <td>{{ time_entry.total_miles }}</td>
                <td>{{ time_entry.travel_miles_subtract }}</td>
                <td>{{ time_entry.miles_to_be_paid }}</td>
            </tr>
            <tr>
                <td>Hours on Site:</td>
                <td>Hours for the Day:</td>
                <td>Travel Time (subtract):</td>
                <td>Hours to be Paid:</td>
                <td colspan="2">Employee's Signature</td>
                <td>Total Miles:</td>
                <td>Travel Miles (subtract):</td>
                <td>Miles to be Paid</td>
            </tr>
        </tfoot>
    </table>
    <div class="workspace-section print-only">
    <!-- Add the Supervisor's Initials and Workspaces section -->
    <table>
        <tr>
            <td colspan="9" style="text-align: center; padding-bottom: 10px; height: 30px;">

            </td>
        </tr>
        <tr>
            <td colspan="9" style="text-align: center; padding-bottom: 10px;">
                Supervisor's Initials
            </td>
        </tr>
        <!-- Spacer row for extra space above workspaces -->
        <tr>
            <td colspan="7" style="height: 30px;">{{ time_entry.comments }}</td>
            <td colspan="3" style="height: 30px;"></td>
        </tr>
        <tr>
            <td colspan="7" style="text-align: center;">Technician's Workspace</td>
            <td colspan="3" style="text-align: center;">Accounting Workspace - Do Not Write Here</td>
        </tr>
    </table>
    <div>
        <table>
            <!-- Spacer row for extra space above next section -->
            <tr>
                <td colspan="7" style="height: 30px;"></td>
                <td colspan="1.5" style="height: 30px;"></td>
                <td colspan="1.5" style="height: 30px;"></td>
            </tr>
            <tr>
                <td colspan="7" style="text-align: center;">Supervisor's Workspace</td>
                <td colspan="1.5" style="text-align: center;">Accounting Manager's Initials</td>
                <td colspan="1.5" style="text-align: center;">Controller's Initials</td>
            </tr>
        </table>
    </div>

    
</div>
<div class="button-container">
    <button onclick="window.print()">Print</button>
    <button><a href="{% url 'time_entry_edit' time_entry.pk %}">Edit</a></button>
    <button><a href="{% url 'time_entry_list' %}">Back to List</a></button>
</div>
<h3>Employee Information</h3>
<p>Employee Name: {{ time_entry.user.get_full_name }}</p>
<p>Distance to Office: {{ time_entry.standard_distance_home_to_office }} miles</p>
<p>Time to Office: {{ time_entry.standard_time_home_to_office|floatformat:2 }} hours</p>

<h3>Time Calculations</h3>
<h4>First Leg Calculations</h4>
<p>Travel Time First Leg: {{ time_entry.travel_time_first_leg|floatformat:2 }} hours</p>
<p>Standard Time from Home to Office: {{ time_entry.standard_time_home_to_office|floatformat:2 }} hours</p>
<p>Time to Subtract First Leg: {{ time_entry.time_to_subtract_first_leg|floatformat:2 }} hours</p>

<h4>Last Leg Calculations</h4>
<p>Travel Time Last Leg: {{ time_entry.travel_time_last_leg|floatformat:2 }} hours</p>
<p>Standard Time from Home to Office: {{ time_entry.standard_time_home_to_office|floatformat:2 }} hours</p>
<p>Time to Subtract Last Leg: {{ time_entry.time_to_subtract_last_leg|floatformat:2 }} hours</p>

<h4>Total Travel Time</h4>
<p>Total Travel Time to Subtract: {{ time_entry.travel_time_subtract|floatformat:2 }} hours</p>

<h3>Mileage Calculations</h3>
<h4>First Leg Calculations</h4>
<p>Miles Traveled First Leg: {{ time_entry.miles_traveled_first_leg|floatformat:2 }} miles</p>
<p>Standard Distance from Home to Office: {{ time_entry.standard_distance_home_to_office|floatformat:2 }} miles</p>
<p>Miles to Subtract First Leg: {{ time_entry.miles_to_subtract_first_leg|floatformat:2 }} miles</p>

<h4>Last Leg Calculations</h4>
<p>Miles Traveled Last Leg: {{ time_entry.miles_traveled_last_leg|floatformat:2 }} miles</p>
<p>Standard Distance from Home to Office: {{ time_entry.standard_distance_home_to_office|floatformat:2 }} miles</p>
<p>Miles to Subtract Last Leg: {{ time_entry.miles_to_subtract_last_leg|floatformat:2 }} miles</p>

<h4>Total Mileage</h4>
<p>Total Miles: {{ time_entry.total_miles|floatformat:2 }} miles</p>
<p>Total Miles to Subtract: {{ time_entry.travel_miles_subtract|floatformat:2 }} miles</p>
<p>Miles to be Paid: {{ time_entry.miles_to_be_paid|floatformat:2 }} miles</p>

{% endblock %}
